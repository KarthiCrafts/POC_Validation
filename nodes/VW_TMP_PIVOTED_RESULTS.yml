fileVersion: 1
id: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
name: VW_TMP_PIVOTED_RESULTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ALLIANT_DW_STAGE
  deployEnabled: true
  description: ""
  isMultisource: true
  locationName: DBSHIFT
  materializationType: view
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2b3c4d5e-6f7a-4b8c-9d0e-1f2a3b4c5d6e
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: UNIQENTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f5a6b7c8-9d0e-4f1a-b2c3-d4e5f6a7b8c9
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.UNIQENTITY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c4d5e6f-7a8b-4c9d-0e1f-2a3b4c5d6e7f
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: UNIQPOLICY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0a1b2c3d-4e5f-4a6b-7c8d-9e0f1a2b3c4d
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.UNIQPOLICY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4d5e6f7a-8b9c-4dae-1f2a-3b4c5d6e7f8a
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: UNIQLINE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b2c3d4e-5f6a-4b7c-8d9e-0f1a2b3c4d5e
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.UNIQLINE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e6f7a8b-9c0d-4ebf-2a3b-4c5d6e7f8a9b
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: POLICYNUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c3d4e5f-6a7b-4c8d-9e0f-1a2b3c4d5e6f
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.POLICYNUMBER
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f7a8b9c-0d1e-4fc0-3b4c-5d6e7f8a9b0c
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: CDPOLICYLINETYPECODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d4e5f6a-7b8c-4d9e-0f1a-2b3c4d5e6f7a
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.CDPOLICYLINETYPECODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a8b9c0d-1e2f-4a1d-4c5d-6e7f8a9b0c1d
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: AGGRLIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d0e1f2a-3b4c-4d5e-6f7a-8b9c0d1e2f3a
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.AGGRLIMIT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b9c0d1e-2f3a-4b2e-5d6e-7f8a9b0c1d2e
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: EACLIMLIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d0e1f2a-3b4c-4d5e-6f7a-8b9c0d1e2f3a
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.EACLIMLIMIT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9c0d1e2f-3a4b-4c3f-6e7f-8a9b0c1d2e3f
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: EXCESSLAYERLIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d0e1f2a-3b4c-4d5e-6f7a-8b9c0d1e2f3a
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.EXCESSLAYERLIMIT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d1e2f3a-4b5c-4d40-7f8a-9b0c1d2e3f4a
          stepCounter: 1a2b3c4d-5e6f-4a7b-8c9d-0e1f2a3b4c5d
        config: {}
        dataType: VARCHAR
        description: ""
        name: RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d0e1f2a-3b4c-4d5e-6f7a-8b9c0d1e2f3a
                stepCounter: e4b5c6d7-1a2b-4c3d-8e4f-5a6b7c8d9e0f
            transform: pvt.RETENTION
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          VW_TMP_SCREEN_DATA: sd
          DW_CLIENT_BENCHMARKING_CLIENT_POLICY_STAGING_EPIC_FORM_MAP: m
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DBSHIFT
            nodeName: VW_TMP_SCREEN_DATA
          - locationName: DBSHIFT
            nodeName: DW_CLIENT_BENCHMARKING_CLIENT_POLICY_STAGING_EPIC_FORM_MAP
        join:
          joinCondition: |
            FROM (
                SELECT
                    sd.UNIQENTITY, sd.UNIQPOLICY, sd.UNIQLINE, sd.POLICYNUMBER, sd.CDPOLICYLINETYPECODE,
                    m.FIELD_NAME, sd.FIELD_DATA
                FROM {{ ref('DBSHIFT','VW_TMP_SCREEN_DATA') }} sd
                INNER JOIN {{ ref('DBSHIFT','DW_CLIENT_BENCHMARKING_CLIENT_POLICY_STAGING_EPIC_FORM_MAP') }} m
                    ON sd.FIELD_ID = m.FIELD_ID
                    AND sd.UNIQCUSTOMFORMMAP = m.UNIQCUSTOMFORMMAP
                WHERE m.PAGE_DESCRIPTION = 'Coverage Type/Limits/Retention'
            ) AS src
            PIVOT (
                MAX(FIELD_DATA)
                FOR FIELD_NAME IN ('AggrLimit', 'EaClaimLimit', 'ExcessLayerLimit', 'Retention')
            ) AS pvt (UNIQENTITY, UNIQPOLICY, UNIQLINE, POLICYNUMBER, CDPOLICYLINETYPECODE, AGGRLIMIT, EACLIMLIMIT, EXCESSLAYERLIMIT, RETENTION)
        name: VW_TMP_PIVOTED_RESULTS
        noLinkRefs: []
  name: VW_TMP_PIVOTED_RESULTS
  overrideSQL: false
  schema: STAGING
  sqlType: View
  type: sql
  version: 1
type: Node