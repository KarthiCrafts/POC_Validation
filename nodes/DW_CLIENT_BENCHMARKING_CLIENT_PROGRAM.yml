fileVersion: 1
id: 282436f5-095a-493e-b81b-561b3662a563
name: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM
operation:
  config:
    insertStrategy: INSERT
    postSQL: |
      BEGIN
          UPDATE ALLIANT_DW.DBO.DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM AS t
          SET
              t.DW_SOURCE_SYSTEM_ID = stg.DW_SOURCE_SYSTEM_ID,
              t.DW_CLIENT_BENCHMARKING_CLIENT_ID = stg.DW_CLIENT_BENCHMARKING_CLIENT_ID,
              t.DW_CLIENT_ID = stg.DW_CLIENT_ID,
              t.DW_STRUCTURE_ID = stg.DW_STRUCTURE_ID,
              t.DW_COMPANY_ID_PRIMARY = stg.DW_COMPANY_ID_PRIMARY,
              t.DW_COMPANY_ID_AGGREGATE = stg.DW_COMPANY_ID_AGGREGATE,
              t.CLIENT_BENCHMARKING_PROGRAM_TYPE_ID = stg.CLIENT_BENCHMARKING_PROGRAM_TYPE_ID,
              t.PRIMARY_LIMIT = stg.PRIMARY_LIMIT,
              t.PRIMARY_PREMIUM = stg.PRIMARY_PREMIUM,
              t.PRIMARY_SIR_RETENTION = stg.PRIMARY_SIR_RETENTION,
              t.PRIMARY_COMPANY_LOOKUP_CODE = stg.PRIMARY_COMPANY_LOOKUP_CODE,
              t.AGGREGATE_LIMIT = stg.AGGREGATE_LIMIT,
              t.AGGREGATE_PREMIUM = stg.AGGREGATE_PREMIUM,
              t.AGGREGATE_SIR_RETENTION = stg.AGGREGATE_SIR_RETENTION,
              t.AGGREGATE_COMPANY_LOOKUP_CODE = stg.AGGREGATE_COMPANY_LOOKUP_CODE,
              t.SOURCE_SYSTEM_PRIMARY_LIMIT = stg.SOURCE_SYSTEM_PRIMARY_LIMIT,
              t.SOURCE_SYSTEM_PRIMARY_PREMIUM = stg.SOURCE_SYSTEM_PRIMARY_PREMIUM,
              t.SOURCE_SYSTEM_PRIMARY_SIR_RETENTION = stg.SOURCE_SYSTEM_PRIMARY_SIR_RETENTION,
              t.SOURCE_SYSTEM_AGGREGATE_LIMIT = stg.SOURCE_SYSTEM_AGGREGATE_LIMIT,
              t.SOURCE_SYSTEM_AGGREGATE_PREMIUM = stg.SOURCE_SYSTEM_AGGREGATE_PREMIUM,
              t.SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION = stg.SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION,
              t.SOURCE_SYSTEM_CLIENT_ID = stg.SOURCE_SYSTEM_CLIENT_ID,
              t.SOURCE_SYSTEM_POLICY_ID = stg.SOURCE_SYSTEM_POLICY_ID,
              t.SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID = stg.SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID,
              t.DW_DATE_UPDATED = CURRENT_TIMESTAMP(),
              t.DW_UPDATE_USER = CURRENT_USER()
          FROM {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING') }} stg
          WHERE t.SOURCE_SYSTEM_POLICY_LINE_ID = stg.SOURCE_SYSTEM_POLICY_LINE_ID
            AND t.PROGRAM_TYPE_KEY = stg.PROGRAM_TYPE_KEY
            AND (
                 IFNULL(stg.DW_SOURCE_SYSTEM_ID, -1) <> IFNULL(t.DW_SOURCE_SYSTEM_ID, -1)
              OR IFNULL(stg.DW_CLIENT_BENCHMARKING_CLIENT_ID, -1) <> IFNULL(t.DW_CLIENT_BENCHMARKING_CLIENT_ID, -1)
              OR IFNULL(stg.DW_CLIENT_ID, -1) <> IFNULL(t.DW_CLIENT_ID, -1)
              OR IFNULL(stg.DW_STRUCTURE_ID, -1) <> IFNULL(t.DW_STRUCTURE_ID, -1)
              OR IFNULL(stg.DW_COMPANY_ID_PRIMARY, -1) <> IFNULL(t.DW_COMPANY_ID_PRIMARY, -1)
              OR IFNULL(stg.DW_COMPANY_ID_AGGREGATE, -1) <> IFNULL(t.DW_COMPANY_ID_AGGREGATE, -1)
              OR IFNULL(stg.CLIENT_BENCHMARKING_PROGRAM_TYPE_ID, '-1') <> IFNULL(t.CLIENT_BENCHMARKING_PROGRAM_TYPE_ID, '-1')
              OR IFNULL(stg.PRIMARY_LIMIT, -1) <> IFNULL(t.PRIMARY_LIMIT, -1)
              OR IFNULL(stg.PRIMARY_PREMIUM, -1) <> IFNULL(t.PRIMARY_PREMIUM, -1)
              OR IFNULL(stg.PRIMARY_SIR_RETENTION, -1) <> IFNULL(t.PRIMARY_SIR_RETENTION, -1)
              OR IFNULL(stg.PRIMARY_COMPANY_LOOKUP_CODE, -1) <> IFNULL(t.PRIMARY_COMPANY_LOOKUP_CODE, -1)
              OR IFNULL(stg.AGGREGATE_LIMIT, -1) <> IFNULL(t.AGGREGATE_LIMIT, -1)
              OR IFNULL(stg.AGGREGATE_PREMIUM, -1) <> IFNULL(t.AGGREGATE_PREMIUM, -1)
              OR IFNULL(stg.AGGREGATE_SIR_RETENTION, -1) <> IFNULL(t.AGGREGATE_SIR_RETENTION, -1)
              OR IFNULL(stg.AGGREGATE_COMPANY_LOOKUP_CODE, -1) <> IFNULL(t.AGGREGATE_COMPANY_LOOKUP_CODE, -1)
              OR IFNULL(stg.SOURCE_SYSTEM_PRIMARY_LIMIT, '-1') <> IFNULL(t.SOURCE_SYSTEM_PRIMARY_LIMIT, '-1')
              OR IFNULL(stg.SOURCE_SYSTEM_PRIMARY_PREMIUM, '-1') <> IFNULL(t.SOURCE_SYSTEM_PRIMARY_PREMIUM, '-1')
              OR IFNULL(stg.SOURCE_SYSTEM_PRIMARY_SIR_RETENTION, '-1') <> IFNULL(t.SOURCE_SYSTEM_PRIMARY_SIR_RETENTION, '-1')
              OR IFNULL(stg.SOURCE_SYSTEM_AGGREGATE_LIMIT, '-1') <> IFNULL(t.SOURCE_SYSTEM_AGGREGATE_LIMIT, '-1')
              OR IFNULL(stg.SOURCE_SYSTEM_AGGREGATE_PREMIUM, '-1') <> IFNULL(t.SOURCE_SYSTEM_AGGREGATE_PREMIUM, '-1')
              OR IFNULL(stg.SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION, '-1') <> IFNULL(t.SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION, '-1')
              OR IFNULL(stg.SOURCE_SYSTEM_CLIENT_ID, -1) <> IFNULL(t.SOURCE_SYSTEM_CLIENT_ID, -1)
              OR IFNULL(stg.SOURCE_SYSTEM_POLICY_ID, -1) <> IFNULL(t.SOURCE_SYSTEM_POLICY_ID, -1)
              OR IFNULL(stg.SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID, -1) <> IFNULL(t.SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID, -1)
            );
          UPDATE ALLIANT_DW.DBO.DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM AS cbcp
          SET
              DW_DATE_DELETED = CURRENT_TIMESTAMP(),
              DW_DATE_UPDATED = CURRENT_TIMESTAMP(),
              DW_UPDATE_USER = CURRENT_USER()
          FROM {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT') }} AS cbc
          WHERE cbc.SOURCE_SYSTEM_POLICY_LINE_ID = cbcp.SOURCE_SYSTEM_POLICY_LINE_ID
            AND cbc.DW_DATE_DELETED IS NOT NULL
            AND cbcp.DW_DATE_DELETED IS NULL;
          UPDATE ALLIANT_DW.DBO.DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM AS cbcp
          SET
              DW_DATE_DELETED = CURRENT_TIMESTAMP(),
              DW_DATE_UPDATED = CURRENT_TIMESTAMP(),
              DW_UPDATE_USER = CURRENT_USER()
          WHERE cbcp.DW_DATE_DELETED IS NULL
            AND NOT EXISTS (
              SELECT 1
              FROM {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING') }} AS cbcps
              WHERE cbcps.PROGRAM_TYPE_KEY = cbcp.PROGRAM_TYPE_KEY
                AND cbcps.SOURCE_SYSTEM_POLICY_LINE_ID = cbcp.SOURCE_SYSTEM_POLICY_LINE_ID
          );
      END
    preSQL: ""
    testsEnabled: true
    truncateBefore: false
  database: ALLIANT_DW
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: DBSHIFT
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97891763-6379-4d37-8e6f-124b80b2d6a5
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_SOURCE_SYSTEM_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.DW_SOURCE_SYSTEM_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e0a2995-1f9e-4e4f-b644-ed31e5e791b7
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_CLIENT_BENCHMARKING_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.DW_CLIENT_BENCHMARKING_CLIENT_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bf89025e-04f7-418e-905b-81d39768340d
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.DW_CLIENT_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 938b8156-f56f-45a7-9565-d04b6b10766e
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_STRUCTURE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.DW_STRUCTURE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8b0c443b-7213-40e1-831d-b8d2abfcb6bb
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_COMPANY_ID_PRIMARY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.DW_COMPANY_ID_PRIMARY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 31f9d45e-d28c-4f74-8898-3164917633f8
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_COMPANY_ID_AGGREGATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.DW_COMPANY_ID_AGGREGATE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 771ff366-069a-47b8-b11c-1e6a9f0f9b37
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: CLIENT_BENCHMARKING_PROGRAM_TYPE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.CLIENT_BENCHMARKING_PROGRAM_TYPE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f7d1591c-29b6-4556-9d22-29ac3992a7cd
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: PROGRAM_TYPE_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.PROGRAM_TYPE_KEY
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97895995-17d1-443b-818f-7c15e8b4009a
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: PRIMARY_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.PRIMARY_LIMIT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ca81254-46ab-41c3-8822-7776b91c13fd
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: PRIMARY_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.PRIMARY_PREMIUM
      - appliedColumnTests: {}
        columnReference:
          columnCounter: caa1c223-bd77-4b72-886f-a6ac75f85022
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: PRIMARY_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.PRIMARY_SIR_RETENTION
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9fcd678f-51d0-496a-8646-a4c330f5a707
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: PRIMARY_COMPANY_LOOKUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.PRIMARY_COMPANY_LOOKUP_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b138c232-a544-48cd-b236-407635607b39
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: AGGREGATE_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.AGGREGATE_LIMIT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f93e5066-5e04-4b53-83f6-c50f8373b9e4
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: AGGREGATE_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.AGGREGATE_PREMIUM
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63b9d031-64d3-467a-8d19-481cf63d0ac5
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: AGGREGATE_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.AGGREGATE_SIR_RETENTION
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a63de33b-8534-45e5-aa94-9694e1d13264
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: AGGREGATE_COMPANY_LOOKUP_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.AGGREGATE_COMPANY_LOOKUP_CODE
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4502d68-07e5-4f7f-af29-ed97df4807a0
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_PRIMARY_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_PRIMARY_LIMIT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dd78ef56-3b60-4491-a128-d72b535ffcc0
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_PRIMARY_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_PRIMARY_PREMIUM
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3122c544-d820-410c-992a-79a8360980ec
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_PRIMARY_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_PRIMARY_SIR_RETENTION
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04edc900-5110-482a-a92c-56eb0f7c2ebc
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_AGGREGATE_LIMIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_AGGREGATE_LIMIT
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 593b4823-380d-400b-9d41-4775d7bce37b
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_AGGREGATE_PREMIUM
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_AGGREGATE_PREMIUM
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 031206c1-a2ac-4b08-8f5b-166d0c0d9501
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_AGGREGATE_SIR_RETENTION
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3175402-990a-4752-9f6b-313d3330b62e
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_CLIENT_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_CLIENT_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9385b0d0-c3d3-4556-9a5c-75051663f45f
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_POLICY_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_POLICY_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7ab6660-f1c6-4384-9387-ec6b37a6b47c
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_POLICY_LINE_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_POLICY_LINE_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a7ab291-7649-43c2-bf72-5b9ac24e7545
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: NUMBER
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: stg.SOURCE_SYSTEM_CUSTOM_FORM_SCREEN_ID
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a281c5d0-d8f9-467f-94a1-0610344d9522
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: TIMESTAMP_NTZ
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_DATE_CREATED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CURRENT_TIMESTAMP()
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b12b591-23d9-45fa-b681-37d4224cc99c
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_CREATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CURRENT_USER()
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 91ab2d17-98c9-46c5-84f5-50e50e5c9288
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: TIMESTAMP_NTZ
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_DATE_UPDATED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CURRENT_TIMESTAMP()
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c0228e93-6c89-498b-986c-0e865f8a6198
          stepCounter: 282436f5-095a-493e-b81b-561b3662a563
        config: {}
        dataType: VARCHAR
        description: ""
        hashDetails:
          hashAlgorithm: MD5
        name: DW_UPDATE_USER
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CURRENT_USER()
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          - alias: d
            identifier: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_SRC
          - alias: stg
            identifier: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DBSHIFT
            nodeName: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING
          - locationName: DBSHIFT
            nodeName: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_SRC
          - locationName: DBSHIFT
            nodeName: DW_CLIENT_BENCHMARKING_CLIENT
        join:
          joinCondition: |
            FROM {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_STAGING') }} stg
            LEFT OUTER JOIN {{ ref('DBSHIFT', 'DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_SRC') }} d ON stg.SOURCE_SYSTEM_POLICY_LINE_ID = d.SOURCE_SYSTEM_POLICY_LINE_ID AND d.PROGRAM_TYPE_KEY = stg.PROGRAM_TYPE_KEY
            WHERE d.DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM_ID IS NULL
        name: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM
        noLinkRefs: []
  name: DW_CLIENT_BENCHMARKING_CLIENT_PROGRAM
  overrideSQL: false
  schema: DBO
  sqlType: Stage
  type: sql
  version: 1

type: Node
